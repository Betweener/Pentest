#! /usr/bin/perl
use strict;
use warnings;
use LWP;
use constant PERL_EOL => "\n";
my $ARGC = @ARGV;
my $notice =
"~ Wh4t Th3 FuCk Scanner by Toufik Airane. Follow \@tfairane.
~ Scanning for Secret/Hidden/Unlinked/Temporary Folders on HTTP Website
~ Using Dictionary Method
~ Usage : ".$0." <Target> <Path Dico>
~ Report bugs : tf.airane\@gmail.com
";
print $notice;
die() if($ARGC!=2);

# config connection
my( $host, $dico) = (
	$ARGV[0],
	$ARGV[1]
	);
# define User Agent
my $agent = LWP::UserAgent->new;
$agent->agent("Wh4t Th3 FuCk Scanner");
print "[+] SCANNING START on ".$host.PERL_EOL.PERL_EOL;
# open Dictionary
open *hFolderListing, "<".$dico or die();
while(<hFolderListing>) {
	chop $_;
	# request HTTP Server
	my $req = HTTP::Request->new('GET', 'http://'.$host.'/'.$_);
	# print HTTP return code ('200' means folder exist)
	print $_.":".$1.PERL_EOL if($agent->request($req)->as_string() =~ /^HTTP\/1.1 (.*)/ig);
}
print PERL_EOL."[+] END OF SCANNING...";